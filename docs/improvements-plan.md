# План доработок (до Demo Day)

Дата: 2025-12-24

## 1) Цель плана

Снизить риски демо (стабильность/воспроизводимость) и обеспечить измеримое преимущество “Улучшенного поиска” (rerank) над baseline.

## 2) Бэклог доработок (приоритеты)

### P0 — обязательно до демо

1. **Обучить reranker и зафиксировать качество**
   - Сгенерировать датасет из текущей БД или использовать `backend/data/training/rerank.jsonl` как старт.
   - Обучить модель (`training/train_reranker.py`) и подключить через `RERANKER_MODEL_PATH`.
   - Прогнать offline‑оценку на >=2000 пар; целевое `pairwise accuracy >= 0.60`.
   - Результат: демонстрируем baseline vs rerank на одинаковых кейсах.

2. **Smoke‑сценарий “поднял стек → загрузил документ → поиск”**
   - Описать/автоматизировать 3–5 шагов, чтобы любой участник команды мог повторить демо за 10 минут.
   - Минимум: `docker compose up`, загрузка 1 PDF/DOCX, поиск baseline и rerank, проверка что метрики появились.

3. **Фиксация демо‑набора документов и контрольных запросов**
   - 10–20 “контрольных” запросов + ожидаемые топ‑источники (ручной oracle).
   - Результат: предсказуемое демо и быстрый регресс при изменениях.

### P1 — желательно до демо

4. **Пороговые SLO для демо и метрики в Grafana**
   - Зафиксировать целевые p95 для baseline/rerank (см. `docs/requirements-v3.md`).
   - Проверить дашборд: RPS/latency/ошибки/доля пустых выдач.

5. **Разбор `npm audit` и обновление зависимостей**
   - Снять отчёт `npm audit`, обновить зависимости до безопасных версий (без поломки сборки).

6. **Production-режим фронтенда (минимальный)**
   - Для демо достаточно dev‑сервера; для релиза — сделать `vite build` + раздача статики (отдельный контейнер nginx или multi-stage Dockerfile).

### P2 — после демо (или если остаётся время)

7. **Миграции БД (Alembic) и управляемая эволюция схемы**
8. **Продуктовые события**
   - Клики по источникам/открытия документа → связать качество поиска с пользой (NSM).
9. **Улучшение чанкинга и цитат**
   - Больше контекста, устойчивость к структуре документов, корректные страницы/ссылки на место в документе.

## 3) Распределение по ролям

- **AI Engineer**
  - P0-1: обучение/оценка reranker, подбор базовой модели, offline‑валидатор.
- **Backend**
  - P0-2: стабильный сценарий загрузки/поиска, обработка ошибок, метрики ошибок/пустых выдач.
- **Frontend**
  - P0-3: список контрольных запросов (UI), UX демо‑сценария, фиксация порога/переключателя rerank.
  - P1-6: подготовка production‑сборки (если идём в релиз).
- **MLOps**
  - P1-4: проверка метрик/дашбордов, базовый нагрузочный прогон (хотя бы 1–2 минуты), кеши моделей.
- **SA/PO**
  - P0-3: контрольные кейсы, критерии “успешного поиска”, формализация NSM/supporting metrics.

## 4) Таймлайн (пример, D = день демо)

- **D-7 … D-5**
  - Сбор контрольных документов/запросов; генерация/подготовка датасета.
- **D-5 … D-3**
  - Обучение reranker + offline‑оценка; подключение модели; сравнение baseline vs rerank на кейсах.
- **D-3 … D-2**
  - Smoke‑прогон “поднял → загрузил → поиск”; стабилизация ошибок; фиксация метрик в Grafana.
- **D-2 … D-1**
  - Разбор `npm audit` (по возможности), полировка UI демо, “прогон презентации”.
- **D-1**
  - Финальный регресс по контрольным кейсам, репетиция демо в чистом окружении.
